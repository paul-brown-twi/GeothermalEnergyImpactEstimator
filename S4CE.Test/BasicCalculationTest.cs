using S4CE.Calculations;
using System;
using System.Linq;
using Xunit;

namespace S4CE.Test
{
	public class BasicCalculationTest
	{
		InputData input;
		public BasicCalculationTest()
		{
			input = new InputData()
			{
				EntryMode = EntryModeEnum.Advanced,
				PlantType = PlantTypeEnum.Conventional,
				AllocationStrategy = AllocationStrategyEnum.Energy,
				ThermalEnergy = true,
				MWn = 16,
				PWn = 64,
				EWn = 0,
				MWd = 2220,
				PWd = 2220,
				EWd = 0,
				D = 2262.06,
				Cs = 100,
				Cc = 40,
				DM = 1,
				CP = 500,
				Pne = 303.3,
				OF = 0,
				CTn = 0.0231023102310231,
                CTel = 864,
                //GF = 1050,
                Sw = 0,
                Sel = 0,
                SWn = 0,
				LT = 30,
				CF = 87,
				Ap = 4,
				Pnh = 133,
				PCh = 1446d/3600d,
				Tenv = 10,
				Tf = 90,
				Ce = 5.87,
				Ch = 0.708,
                ECO2 = 20.9 / 1000d,
                DW = 450,
                SRp = 100,
                SRe = 100,
                SRm = 100,
                CH4 = 3.50E-05
            };
		}

		private void ValuesMatch(double[,] EResult, double[,] HResult, double[,,]EInter, double[,,]HInter)
		{
			ParametricModel model = new ParametricModel(input);
            double lifetimeE = (input.Pne * input.CF / 100d * (1 - (input.Ap / 100d)) * input.LT * 8760000);// - (1000.0 * input.Pne * input.CTn * input.CTel* input.LT);
            double lifetimeh = input.Pnh * input.CF / 100d * input.LT * 31536000;

            model.Calculate();
			for (int a = 0; a < 3; a++)
			{
				for (int i = 0; i < EResult.GetLongLength(1); i++)
				{
					Assert.Equal(EResult[a, i], model.Results.ImpactElectricity[a, i], 8);
					Assert.Equal(HResult[a, i], model.Results.ImpactHeat[a, i], 8);
                    if (EInter == null)
                        continue;
					for (int j = 0; j < EInter.GetLongLength(2); j++)
					{
                        Assert.Equal(EInter[a, i, j], model.Results.IntermediateEnergyColumns[a, i, j] *  lifetimeE, 1);
                        Assert.Equal(HInter[a, i, j], model.Results.IntermediateThermalColumns[a, i, j] * lifetimeh, 1);
					}
				}
			}
		}

		[Fact]
		public void AllocationFactorsCorrectlyCalculated()
		{
			ParametricModel model = new ParametricModel(input);
			model.Calculate();
			Assert.Equal(0.686444993493, model.Results.Energya, 7);
			Assert.Equal(0.908573517691, model.Results.Exergya, 7);
			Assert.Equal(0.834489188117, model.Results.Economica, 7);
        }

        [Fact]
		public void SpreadsheetIsReplicated()
		{
            double[,] EResult = new double[,] {
                { 0.000013699983445400, 0.023994616415279700, 0.000000090551317600, 0.000004021555172606, 0.000042529575054132, 0.007882994105368180, 0.000000000326047335, 0.000000000948347600, 0.000062723328346899, 0.010214617125407100, 0.000000000204068197, 0.000000000114957240, 0.000013300787926090, 0.025292235568042900, 0.000000057720808625, 0.000680995037187417 },
                { 0.000016662092761610, 0.024368384794421300, 0.000000107375658180, 0.000005045314957723, 0.000053658332152309, 0.009994147258035920, 0.000000000406461483, 0.000000001160759015, 0.000076152450863909, 0.011888079293867100, 0.000000000246335100, 0.000000000137125265, 0.000016587787622345, 0.030559910060881800, 0.000000065085805579, 0.000796516009700977 },
                { 0.000015674169739983, 0.024243725523917800, 0.000000101764402278, 0.000004703870482734, 0.000049946667873338, 0.009290035228717030, 0.000000000379641748, 0.000000001089915537, 0.000071673568460007, 0.011329946009252500, 0.000000000232238238, 0.000000000129731783, 0.000015491507125795, 0.028803034690538700, 0.000000062629430993, 0.000757987442371491 },
            };

            double[,] HResult = new double[,] {
                { 0.000003017053540205, 0.000482682429121841, 0.000000018426564415, 0.000000976419448967, 0.000010631006594183, 0.002004087534711010, 0.000000000081904044, 0.000000000213652237, 0.000013570634334867, 0.002005860250144490, 0.000000000041955148, 0.000000000025819312, 0.000003244605164764, 0.005615160060624410, 0.000000009463398111, 0.000129728788151254 },
                { 0.000001226017167158, 0.000256683760377824, 0.000000008253744064, 0.000000357404140391, 0.000003902014979805, 0.000727580936926013, 0.000000000033281712, 0.000000000085217892, 0.000005450729119196, 0.000994003058976999, 0.000000000016398508, 0.000000000012415439, 0.000001257124155210, 0.002430066058043100, 0.000000005010160224, 0.000059879150094557 },
                { 0.000001823363813287, 0.000332058860981793, 0.000000011646584215, 0.000000563858193499, 0.000006146268995617, 0.001153321556392480, 0.000000000049498238, 0.000000000128053329, 0.000008158880790741, 0.001331477779536030, 0.000000000024922161, 0.000000000016885900, 0.000001919989037894, 0.003492358956545060, 0.000000006495404609, 0.000083175408983754 },
            };

            #region intermediate values
            //         double[,,] EInter = new double[,,]
            //         {
            //             {
            //                 { 5.365770090585E+05, 9.939723505781E+04, 2.904533069307E+05,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.338240992266E+01, 3.322393768507E+00, 5.208858217822E+00,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 6.349039883494E+07, 1.710620923785E+07, 4.374221782178E+07,2.090000000000E-02, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.886026962065E+08, 4.008838762000E+07, 7.781289207921E+07,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.858149306222E+04, 1.081837309745E+04, 3.029628217822E+04,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.875144785436E+05, 1.784756983082E+04, 5.503928118812E+04,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.063629087599E+06, 1.985198921182E+05, 4.998045346535E+05,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.364533174419E+06, 6.589871937534E+05, 2.263059207921E+06,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.061176377819E+08, 8.072593123479E+07, 2.323131683168E+08,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.434392988883E+01, 7.852930725562E+00, 1.510783861386E+01,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 7.886664784726E+00, 9.280736312027E-01, 3.847025742574E+00,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 5.960497948865E+05, 6.946823334151E+04, 1.767011336634E+05,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 9.057096102661E+08, 2.067572320401E+08, 5.823019504950E+08,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.067315607041E+02, 1.265804568001E+02, 5.253321980198E+02,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.299246816219E+01, 4.969861752890E+00, 1.212482792079E+01,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.849282797763E+07, 5.354270949247E+06, 3.562566336634E+07,0.000000000000E+00, 0.000000000000E+00,  0.000000000000E+00, 0.000000000000E+00 },
            //             },
            //             {
            //                 { 5.559458541606E+05, 1.029851816469E+05, 2.904533069307E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.386547539231E+01, 3.442322369964E+00, 5.208858217822E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 6.578221469686E+07, 1.772369286353E+07, 4.374221782178E+07, 0.000000000000E+00, 2.090000000000E-02, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 4.026301056966E+08, 4.153546000122E+07, 7.781289207921E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.961320053861E+04, 1.120888441129E+04, 3.029628217822E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.942831973445E+05, 1.849181438410E+04, 5.503928118812E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.138120002177E+06, 2.056858738416E+05, 4.998045346535E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.485982883959E+06, 6.827746849515E+05, 2.263059207921E+06, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.135578756818E+08, 8.363989890656E+07, 2.323131683168E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.558364431376E+01, 8.136398329005E+00, 1.510783861386E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 8.171350088063E+00, 9.615743479734E-01, 3.847025742574E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 6.175654318880E+05, 7.197583137197E+04, 1.767011336634E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 9.384030519391E+08, 2.142205574035E+08, 5.823019504950E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.178036640311E+02, 1.311496374011E+02, 5.253321980198E+02, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.382242834839E+01, 5.149259082343E+00, 1.212482792079E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.952133490637E+07, 5.547544315231E+06, 3.562566336634E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //             },
            //             {
            //                 { 6.522994805063E+05, 1.208340344394E+05, 2.904533069307E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.626856703344E+01, 4.038927670489E+00, 5.208858217822E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 7.718324392958E+07, 2.079547056789E+07, 4.374221782178E+07, 0.000000000000E+00, 2.090000000000E-02, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 4.724118487738E+08, 4.873416858606E+07, 7.781289207921E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.474560549900E+04, 1.315154960473E+04, 3.029628217822E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.279553444827E+05, 2.169671889105E+04, 5.503928118812E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.508687772815E+06, 2.413342732036E+05, 4.998045346535E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 4.090155196307E+06, 8.011096205928E+05, 2.263059207921E+06, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.505706092108E+08, 9.813592852262E+07, 2.323131683168E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 4.175081534771E+01, 9.546556312064E+00, 1.510783861386E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 9.587565727110E+00, 1.128229382335E+00, 3.847025742574E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 7.245986410087E+05, 8.445030583749E+04, 1.767011336634E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 1.101042158520E+09, 2.513481434610E+08, 5.823019504950E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.728837321100E+02, 1.538798062889E+02, 5.253321980198E+02, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 2.795120697413E+01, 6.041701721971E+00, 1.212482792079E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //                 { 3.463781819607E+07, 6.509015667316E+06, 3.562566336634E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00 },
            //             }
            //         };

            //double[,,] HInter = new double[,,]
            //{
            //             {
            //               { 2.450981639630E+05, 4.540276494219E+04, 4.774000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 5.302776414302E+03 },
            //               { 6.112830117710E+00, 1.517606231493E+00, 1.296000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.254315562945E-01 },
            //               { 2.900120564432E+07, 7.813790762151E+06, 8.823000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 8.653886624211E+06 },
            //               { 1.775063145519E+08, 1.831161238000E+07, 1.680000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.899176880207E+06 },
            //               { 1.305548198042E+04, 4.941626902548E+03, 5.079000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.989336145672E+02 },
            //               { 8.565304444960E+04, 8.152430169178E+03, 8.609000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.490510539218E+03 },
            //               { 9.426264859144E+05, 9.068010788178E+04, 9.270000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.580913902750E+04 },
            //               { 1.536854709988E+06, 3.010128062466E+05, 3.448000000000E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.598373760049E+04 },
            //               { 9.415061347742E+07, 3.687406876521E+07, 4.291000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.971599990681E+06 },
            //               { 1.568765343449E+01, 3.587069274438E+00, 2.716000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.280062290384E-01 },
            //               { 3.602478350535E+00, 4.239263687973E-01, 5.199000000000E-01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 7.247464118191E-02 },
            //               { 2.722642004612E+05, 3.173176665849E+04, 3.909000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 4.820776219687E+03 },
            //               { 4.137109097339E+08, 9.444276795986E+07, 1.099300000000E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 9.700682985955E+06 },
            //               { 1.401091382763E+02, 5.781954319986E+01, 6.380000000000E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 5.487181302027E+00 },
            //               { 1.050252179350E+01, 2.270138247110E+00, 2.505000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.294547855882E-01 },
            //               { 1.301498145752E+07, 2.445729050753E+06, 3.377000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 2.057650704172E+10, 3.976549757274E+05 },
            //             },
            //             {
            //               { 2.257293188609E+05, 4.181481835315E+04, 4.774000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 5.434178738629E+03 },
            //               { 5.629764648059E+00, 1.397677630036E+00, 1.296000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.288830325968E-01 },
            //               { 2.670938978240E+07, 7.196307136467E+06, 8.823000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 8.670539156498E+06 },
            //               { 1.634789050618E+08, 1.686453999878E+07, 1.680000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.987751229490E+06 },
            //               { 1.202377450402E+04, 4.551115588713E+03, 5.079000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 4.070742492540E+02 },
            //               { 7.888432564877E+04, 7.508185615897E+03, 8.609000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.532941582196E+03 },
            //               { 8.681355713372E+05, 8.351412615836E+04, 9.270000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.627653473834E+04 },
            //               { 1.415405000447E+06, 2.772253150485E+05, 3.448000000000E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.681506046182E+04 },
            //               { 8.671037557753E+07, 3.396010109344E+07, 4.291000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.030866402860E+06 },
            //               { 1.444793900957E+01, 3.303601670995E+00, 2.716000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.367247669593E-01 },
            //               { 3.317793047198E+00, 3.904256520266E-01, 5.199000000000E-01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 7.429590537130E-02 },
            //               { 2.507485634597E+05, 2.922416862803E+04, 3.909000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 4.958282756468E+03 },
            //               { 3.810174680609E+08, 8.697944259647E+07, 1.099300000000E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 9.930536207477E+06 },
            //               { 1.290370349493E+02, 5.325036259890E+01, 6.380000000000E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 5.576710409197E+00 },
            //               { 9.672561607306E+00, 2.090740917657E+00, 2.505000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.352322446259E-01 },
            //               { 1.198647452878E+07, 2.252455684769E+06, 3.377000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 2.057650704172E+10, 4.046483209955E+05 },
            //             },
            //             {
            //               { 1.293756925152E+05, 2.396596556059E+04, 4.774000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 6.087862032206E+03 },
            //               { 3.226673006926E+00, 8.010723295114E-01, 1.296000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.460529906516E-01 },
            //               { 1.530836054968E+07, 4.124529432113E+06, 8.823000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 8.753380021051E+06 },
            //               { 9.369716198464E+07, 9.665831413939E+06, 1.680000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.428379450201E+06 },
            //               { 6.891369543639E+03, 2.608450395269E+03, 5.079000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 4.475712261615E+02 },
            //               { 4.521217851055E+04, 4.303281108946E+03, 8.609000000000E+03, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.744022048738E+03 },
            //               { 4.975678006986E+05, 4.786572679643E+04, 9.270000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.860167448937E+04 },
            //               { 8.112326880992E+05, 1.588903794072E+05, 3.448000000000E+05, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 4.095061794764E+04 },
            //               { 4.969764204848E+07, 1.946407147738E+07, 4.291000000000E+07, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.325697287398E+06 },
            //               { 8.280767975611E+00, 1.893443687936E+00, 2.716000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 3.800966221566E-01 },
            //               { 1.901577408152E+00, 2.237706176652E-01, 5.199000000000E-01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 8.335609498283E-02 },
            //               { 1.437153543390E+05, 1.674969416251E+04, 3.909000000000E+04, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 5.642332496928E+03 },
            //               { 2.183783614797E+08, 4.985185653902E+07, 1.099300000000E+08, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 1.107398029535E+07 },
            //               { 7.395696687041E+01, 3.052019371114E+01, 6.380000000000E+01, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 6.022088236002E+00 },
            //               { 5.543782981564E+00, 1.198298278029E+00, 2.505000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 0.000000000000E+00, 2.639732008581E-01 },
            //               { 6.869991239077E+06, 1.290984332684E+06, 3.377000000000E+06, 0.000000000000E+00, 0.000000000000E+00, 2.057650704172E+10, 4.394379108401E+05 },
            //             }
            //         };

            #endregion
            ValuesMatch(EResult, HResult, null, null);
		}

		[Fact]
		public void SpreadsheetReplicatedWithStimulation1500()
		{
            input.SWn = 5;
            input.Sw = 1000;
            input.Sel = 50;

            double[,] EResult = new double[,] {
                { 0.000013820405259230, 0.024003293307471600, 0.000000090582831754, 0.000004074701179351, 0.000043111824152267, 0.007884905528897230, 0.000000000326088246, 0.000000000948639308, 0.000063226260005704, 0.010220986222899900, 0.000000000205911956, 0.000000000115129303, 0.000013453324098104, 0.025407676451845600, 0.000000057767781100, 0.000681262281590220 },
                { 0.000016821482183975, 0.024379869464768000, 0.000000107417370082, 0.000005115658619280, 0.000054428992753346, 0.009996677204085560, 0.000000000406515632, 0.000000001161145117, 0.000076818127488737, 0.011896509384214300, 0.000000000248775485, 0.000000000137353007, 0.000016789683371744, 0.030712706761092600, 0.000000065147978000, 0.000796869732416473 },
                { 0.000015820562681307, 0.024254273743788700, 0.000000101802713026, 0.000004768478380586, 0.000050654489449414, 0.009292358885068260, 0.000000000379691482, 0.000000001090270157, 0.000072284966366050, 0.011337688717038600, 0.000000000234479636, 0.000000000129940955, 0.000015676940463570, 0.028943372474794100, 0.000000062686533926, 0.000758312322830723 },
            };


            double[,] HResult = new double[,] {
                { 0.000003050922066936, 0.000485122797239551, 0.000000018435427742, 0.000000991366715520, 0.000010794763628870, 0.002004625120857820, 0.000000000081915551, 0.000000000213734280, 0.000013712083411147, 0.002007651553080630, 0.000000000042473703, 0.000000000025867705, 0.000003287505825824, 0.005647627705269520, 0.000000009476609077, 0.000129803950398959 },
                { 0.000001236323969183, 0.000257426408301605, 0.000000008256441335, 0.000000361952862525, 0.000003951849191673, 0.000727744534062396, 0.000000000033285214, 0.000000000085242859, 0.000005493774617971, 0.000994548184688458, 0.000000000016556314, 0.000000000012430165, 0.000001270179598212, 0.002439946546445970, 0.000000005014180559, 0.000059902023318805 },
                { 0.000001841528924301, 0.000333367732729485, 0.000000011651337989, 0.000000571875039300, 0.000006234098759755, 0.001153609886384340, 0.000000000049504409, 0.000000000128097332, 0.000008234745861398, 0.001332438530411130, 0.000000000025200285, 0.000000000016911855, 0.000001942998461272, 0.003509772715756900, 0.000000006502490204, 0.000083215721648797 },
            };
            ValuesMatch(EResult, HResult, null, null);
    	}

	}
}
